<div>

    <h2>My Trips</h2>

    <!--  START:  Outer Accordion  -->
    <uib-accordion close-others="oneAtATime">

        <!--  START:  Add Trip Accordion-group  -->
        <div uib-accordion-group class="panel-primary" uib-collapse="mtc.status.isCollapsed" heading="Add a Trip">
            <form name="tripAdd" novalidate>

                <div class="form-group" ng-model="mtc.newTrip.trip_name">
                    <ng-form name="addTripForm">
                        <label>Trip Name</label>
                        <input type="text" class="form-control" name="trip_name" ng-model="mtc.newTrip.trip_name" required>
                        <p class="help-block" ng-show="userFieldForm.trip_name.$invalid">Trip Name Required</p>
                        <label>Starting Date</label>
                        <input type="date" class="form-control" name="begin_date" ng-model="mtc.newTrip.begin_date">
                        <label>Starting Location</label>
                        <input type="text" class="form-control" name="begin_location" ng-model="mtc.newTrip.begin_location">
                        <label>Ending Date</label>
                        <input type="date" class="form-control" name="end_date" ng-model="mtc.newTrip.end_date">
                        <label>Ending Location</label>
                        <input type="text" class="form-control" name="end_location" ng-model="mtc.newTrip.end_location">
                        <label>Travellers</label>
                        <input type="text" class="form-control" name="travellers" ng-model="mtc.newTrip.travellers">
                        <button class="btn btn-default btn-md" ng-click="mtc.addTrip()">Save</button>
                    </ng-form>
                </div>

            </form>
        </div>
        <!--  END: Add Trip Accordion-group  -->

        <!--  START: Show Trips Accordion-group  -->
        <!-- <div uib-accordion-group ng-repeat="trip in mtc.trips" ng-click="mtc.getDays(trip._id)" class="panel-default" is-disabled="mtc.status.isFirstDisabled"> -->
        <div uib-accordion-group ng-repeat="trip in mtc.trips" class="panel-default" is-disabled="mtc.status.isFirstDisabled">
            <div>
                <uib-accordion-heading>
                    <span ng-click="mtc.getDays(trip._id)">{{trip.begin_date | date:'yyyy - MMMM'}} - {{trip.trip_name}}</span>
                    <span class="deleteBtn pull-right fa fa-trash" ng-click="mtc.deleteTrip(trip._id)"></span>
                    <span class="updateBtn pull-right fa fa-check" ng-click="mtc.updateTrip(trip)"></span>
                </uib-accordion-heading>

                <h4><a editable-text="trip.travellers" buttons="no">{{trip.travellers || 'empty' }}</a> -- the <a editable-text="trip.trip_name" buttons="no">{{trip.trip_name || 'empty' }}</a> trip</h4>
                <h5>Starting on <a editable-date="trip.begin_date" buttons="no">{{trip.begin_date | date }}</a> in <a buttons="no" editable-text="trip.begin_location">{{trip.begin_location || 'empty' }}</a>, and ending on <a editable-date="trip.end_date" buttons="no">{{trip.end_date | date }}</a> in <a buttons="no" editable-text="trip.end_location">{{trip.end_location || 'empty' }}</a></h5>
            </div>

            <!--  START: Add Day -->
            <div uib-accordion-group class="panel-primary" is-disabled="mtc.statusInner.isFirstDisabled">
                <uib-accordion-heading>
                    Add a Day
                </uib-accordion-heading>

                <div class="form-group" ng-model="mtc.newDay.trip_name">
                    <ng-form name="addDayForm">

                        <div class="daySection form-group">
                            <label>General</label><br>
                            <div class="col-xs-2">
                                <input type="date" class="form-control" name="date" ng-model="mtc.newDay.date">
                            </div>
                            <div class="col-xs-2">
                                <label class="sr-only" for="dayEndLocation">Location</label>
                                <input type="text" class="form-control" name="dayEndLocation" ng-model="mtc.newDay.end_location" placeholder="Where are you?">
                            </div>
                            <div class="col-xs-6">
                                <label class="sr-only">Tag Line</label>
                                <input type="text" class="form-control" name="tag_line" ng-model="mtc.newDay.tag_line" placeholder="Tag line for the day">
                            </div>
                            <div class="col-xs-2">
                                <input type="text" class="form-control" name="weather" ng-model="mtc.newDay.weather" placeholder="Today's Weather">
                            </div>
                        </div><br>

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Points of Interest</label><br>
                            <div class="col-xs-3">
                                <input type="text" class="form-control" name="pointOfInterestName" ng-model="mtc.pointOfInterest.name" placeholder="Add point of interest">
                            </div>
                            <div class="col-xs-8">
                                <input type="text" class="form-control" name="pointOfInterestDesc" ng-model="mtc.pointOfInterest.description" placeholder="Description">
                            </div>
                            <div class="col-xs-1">
                                <button type="button" class="form-control btn btn-xs btn-default" ng-click="mtc.addPOI()"><span class=" fa fa-plus"></span> Add</button>
                            </div><br>
                            <div class="col-xs-12">
                                <table class="dayTable table table-hover table-responsive">
                                    <thead class=>
                                        <tr>
                                            <th style="width:20%">Name</th>
                                            <th style="width:80%">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody class="routes" ng-repeat="place in mtc.newDay.interesting_locations">
                                        <tr>
                                            <td>{{place.name}}</td>
                                            <td>{{place.description}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Routes</label><br>
                            <div class="col-xs-2">
                                <input type="text" class="form-control" name="routeName" ng-model="mtc.route.name" placeholder="Point on route">
                            </div>
                            <div class="col-xs-1">
                                <select class="form-control" ng-model="mtc.route.transport_mode" ng-options="item for item in mtc.transportModes"></select>
                            </div>
                            <div class="col-xs-2">
                                <input type="text" class="form-control" name="routeDistance" ng-model="mtc.route.distance" placeholder="Distance">
                            </div>
                            <div class="col-xs-2">
                                <input type="text" class="form-control" name="routeDuration" ng-model="mtc.route.duration" placeholder="Duration">
                            </div>
                            <div class="col-xs-5">
                                <input type="text" class="form-control" name="routeSpecifics" ng-model="mtc.route.specifics" placeholder="Specifics">
                            </div><br>
                            <div class="col-xs-11">
                                <input type="text" class="form-control" name="routeComment" ng-model="mtc.route.comment" placeholder="Comments">
                            </div>
                            <div class="col-xs-1">
                                <button type="button" class="form-control btn btn-xs btn-default" ng-click="mtc.addRoute()"><span class="fa fa-plus"></span> Add</button>
                            </div>
                            <div class="col-xs-12">
                                <table class="dayTable table table-hover table-responsive">
                                    <thead class=>
                                        <tr>
                                            <th style="width:10%">Name</th>
                                            <th style="width:10%">Mode</th>
                                            <th style="width:5%">Distance</th>
                                            <th style="width:5%">Duration</th>
                                            <th style="width:20%">Specfics</th>
                                            <th style="width:50%">Comment</th>
                                        </tr>
                                    </thead>
                                    <tbody class="routes" ng-repeat="route in mtc.newDay.routes">
                                        <tr>
                                            <td>{{route.name}}</td>
                                            <td>{{route.transport_mode}}</td>
                                            <td>{{route.distance}}</td>
                                            <td>{{route.duration}}</td>
                                            <td>{{route.specifics}}</td>
                                            <td>{{route.comment}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>


                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Meals</label>
                            <div class="col-xs-12">
                                <table class="dayTable table table-hover table-responsive">
                                    <thead class=>
                                        <tr>
                                            <th style="width:10%">type</th>
                                            <th style="width:10%">Name</th>
                                            <th style="width:20%">Location</th>
                                            <th style="width:40%">Description</th>
                                            <th style="width:20%">reference</th>
                                        </tr>
                                    </thead>
                                    <tbody class="meals" ng-repeat="meal in day.meals">
                                        <tr>
                                            <td>{{meal.type}}</td>
                                            <td>{{meal.name}}</td>
                                            <td>{{meal.location}}</td>
                                            <td>{{meal.description}}</td>
                                            <td>{{meal.reference}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Lodging</label><br>
                            <div class="col-xs-2">
                                <label class="sr-only">Type</label>
                                <select class="form-control" ng-model="day.lodgingTypes_type" ng-options="item for item in day.lodgingTypes"></select>
                            </div>
                            <div class="col-xs-4">
                                <input type="text" class="form-control" name="lodging_name" ng-model="mtc.newDay.lodging_name" placeholder="Name">
                            </div>
                            <div class="col-xs-6">
                                <label class="sr-only">Address</label>
                                <input type="text" class="form-control" name="lodging_address" ng-model="mtc.newDay.lodging_address" placeholder="Address">
                            </div><br>
                            <div class="col-xs-12">
                                <label class="sr-only">Reference</label>
                                <input type="text" class="form-control" name="lodging_reference" ng-model="mtc.newDay.lodging_reference" placeholder="Reference">
                            </div>
                        </div><br>

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Narrative</label><br>
                            <div class="col-xs-12">
                                <input type="text" class="form-control" name="narrative" ng-model="mtc.newDay.narrative" placeholder="Describe the day">
                            </div>
                        </div><br>

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Recommendations</label><br>
                            <div class="col-xs-12">
                                <table class="dayTable table table-hover table-responsive">
                                    <thead class=>
                                        <tr>
                                            <th style="width:100%">Recommendation</th>
                                            \ </tr>
                                    </thead>
                                    <tbody class="recommendations" ng-repeat="recommendation in mtc.newDay.recommendations">
                                        <tr>
                                            <td>{{recommendation.text}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="dayLabel sr-only">Save</label>
                            <div class="col-xs-2 col-xs-offset-5 text-center">
                                <button class="form-control btn btn-primary btn-lg" ng-click="mtc.addDay(trip._id)">Save</button>
                            </div>
                        </div>

                    </ng-form>

                </div>

            </div>
            <!--  END: Add day accordion-group (within a trip)  -->

            <!--  START: Show days accordion group (within a trip) -->
            <div uib-accordion-group ng-repeat="day in mtc.days" class="panel-default" is-disabled="mtc.statusInner.isFirstDisabled">
                <uib-accordion-heading>
                    {{day.date | date:'MM/dd'}} - {{day.end_location}}
                    <span class="deleteBtn pull-right fa fa-trash" ng-click="mtc.deleteDay(day._id)"></span>
                </uib-accordion-heading>

                <div class="col-xs-12">
                  <form editable-form name="editableFormGeneral">
                      <div class="col-xs-2">
                          <!-- <span class="title">Date: </span> -->
                          <span editable-date="day.date" e-name="date" e-required>{{ day.date | date:'MM/dd' }}</span>
                      </div>

                      <div class="col-xs-2">
                          <!-- <span class="title">Where: </span> -->
                          <span editable-text="day.end_location" e-name="end_location" e-required>{{ day.end_location || 'empty' }}</span>
                      </div>

                      <div class="col-xs-3">
                          <!-- <span class="title">Tag-line: </span> -->
                          <span editable-text="day.tag_line" e-name="tag_line" e-required>{{ day.tag_line || 'empty' }}</span>
                      </div>

                      <div class="col-xs-4">
                          <!-- <span class="title">Weather: </span> -->
                          <span editable-text="day.weather" e-name="weather" e-required>{{ day.weather || 'empty' }}</span>
                      </div>

                      <div>
                          <!-- button to show form -->
                          <button type="button" class="editBtn pull-right fa fa-pencil" ng-click="editableFormGeneral.$show()" ng-show="!editableFormGeneral.$visible"></button>
                          <!-- buttons to submit / cancel form -->
                          <span ng-show="editableFormGeneral.$visible">
                            <button type="button" class="cancelBtn pull-right fa fa-ban" ng-disabled="editableFormGeneral.$waiting" ng-click="editableFormGeneral.$cancel()"></button>
                            <button type="submit" class="updateBtn pull-right fa fa-check" ng-disabled="editableFormGeneral.$waiting" ng-click="mtc.updateDayGeneral(editableFormGeneral.$data, day._id, day.trip_id)"></button>
                          </span>
                      </div>
                  </form>
                </div>

                <!-- Starting Points of Interest -->

                <form editable-form name="tableformPOI" onaftersave="savePOITable()" oncancel="cancel()">
                  <label class="dayLabel col-xs-12"></label>
                  <!-- table -->
                  <div class="col-xs-11">
                    <table class="table table-bordered table-hover table-condensed">
                      <tr style="font-weight: bold">
                        <td style="width:20%">Name</td>
                        <td style="width:60%">Description</td>
                        <td style="width:10%"><span ng-show="tableformPOI.$visible">Action</span></td>
                      </tr>
                      <tr ng-repeat="place in day.interesting_locations">
                        <td>
                          <span editable-text="place.name" e-form="tableformPOI">
                            {{ place.name || 'empty' }}
                          </span>
                        </td>
                        <td>
                          <span editable-text="place.description" e-form="tableformPOI">
                            {{ place.description || 'empty' }}
                          </span>
                        </td>
                        <td><button type="button" ng-show="tableformPOI.$visible" ng-click="mtc.deletePOI(place._id, day._id, day.trip_id)" class="deleteBtn pull-right fa fa-trash"></button></td>
                      </tr>
                      <div class="btn-form" ng-show="tableformPOI.$visible">
                        <tr ng-show="tableformPOI.$visible">
                          <td></td><td></td><td><button type="button" ng-disabled="tableformPOI.$waiting" ng-click="mtc.addPOI($index)" class="addBtn pull-right fa fa-plus"></button></td>
                        </tr>
                      </div>
                    </table>
                  </div>

                  <div class="col-xs-1">
                    <!-- buttons -->
                    <div class="btn-edit">
                      <button type="button" class="editBtn pull-right fa fa-pencil" ng-show="!tableformPOI.$visible" ng-click="tableformPOI.$show()"></button>
                    </div>
                    <div class="btn-form" ng-show="tableformPOI.$visible">
                      <button type="button" ng-disabled="tableformPOI.$waiting" ng-click="tableformPOI.$cancel()" class="cancelBtn pull-right fa fa-ban"></button>
                      <button type="submit" ng-disabled="tableformPOI.$waiting" ng-click="mtc.updateDayPOI($index, day._id, day.trip_id)" class="updateBtn pull-right fa fa-check"></button>
                    </div>
                  </div>

                </form>



                <!-- <div class="form-group" ng-model="mtc.newDay.trip_name">
                    <ng-form name="addDayForm">

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Points of Interest</label><br>
                            <div class="col-xs-12">
                                <table class="dayTable table table-hover table-responsive">
                                    <thead class=>
                                        <tr>
                                            <th style="width:20%">Name</th>
                                            <th style="width:80%">Description</th>
                                        </tr>
                                    </thead>
                                    <tbody class="routes" ng-repeat="place in day.interesting_locations">
                                        <tr>
                                            <td>{{place.name}}</td>
                                            <td>{{place.description}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>





                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Routes</label><br>
                            <div class="col-xs-12">
                                <table class="dayTable table table-hover table-responsive">
                                    <thead class=>
                                        <tr>
                                            <th style="width:10%">Name</th>
                                            <th style="width:10%">Mode</th>
                                            <th style="width:5%">Distance</th>
                                            <th style="width:5%">Duration</th>
                                            <th style="width:20%">Specfics</th>
                                            <th style="width:50%">Comment</th>
                                        </tr>
                                    </thead>
                                    <tbody class="routes" ng-repeat="route in day.routes">
                                        <tr>
                                            <td>{{route.name}}</td>
                                            <td>{{route.transport_mode}}</td>
                                            <td>{{route.distance}}</td>
                                            <td>{{route.duration}}</td>
                                            <td>{{route.specifics}}</td>
                                            <td>{{route.comment}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Meals</label><br>
                            <div class="col-xs-12">
                                <table class="dayTable table table-hover table-responsive">
                                    <thead class=>
                                        <tr>
                                            <th style="width:10%">type</th>
                                            <th style="width:10%">Name</th>
                                            <th style="width:20%">Location</th>
                                            <th style="width:40%">Description</th>
                                            <th style="width:20%">reference</th>
                                        </tr>
                                    </thead>
                                    <tbody class="meals" ng-repeat="meal in day.meals">
                                        <tr>
                                            <td>{{meal.type}}</td>
                                            <td>{{meal.name}}</td>
                                            <td>{{meal.location}}</td>
                                            <td>{{meal.description}}</td>
                                            <td>{{meal.reference}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Lodging</label><br>
                            <div class="col-xs-2">
                                <label class="sr-only">Type</label>
                                <select class="form-control" ng-model="day.lodgingTypes_type" ng-options="item for item in day.lodgingTypes"></select>
                            </div>
                            <div class="col-xs-4">
                                <input type="text" class="form-control" name="lodging_name" ng-model="day.lodging_name" placeholder="Name">
                            </div>
                            <div class="col-xs-6">
                                <label class="sr-only">Address</label>
                                <input type="text" class="form-control" name="lodging_address" ng-model="day.lodging_address" placeholder="Address">
                            </div><br>
                            <div class="col-xs-12">
                                <label class="sr-only">Reference</label>
                                <input type="text" class="form-control" name="lodging_reference" ng-model="day.lodging_reference" placeholder="Reference">
                            </div>
                        </div><br>

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Narrative</label><br>
                            <div class="col-xs-12">
                                <input type="text" class="form-control" name="narrative" ng-model="day.narrative" placeholder="Describe the day">
                            </div>
                        </div><br>

                        <div class="daySection form-group">
                            <label class="dayLabel col-xs-12">Recommendations</label><br>
                            <div class="col-xs-12">
                                <table class="dayTable table table-hover table-responsive">
                                    <thead class=>
                                        <tr>
                                            <th style="width:100%">Recommendation</th>
                                        </tr>
                                    </thead>
                                    <tbody class="recommendations" ng-repeat="recommendation in day.recommendations">
                                        <tr>
                                            <td>{{recommendation.text}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="dayLabel sr-only">Save</label>
                            <div class="col-xs-2 col-xs-offset-5 text-center">
                                <button class="form-control btn btn-primary btn-lg" ng-click="mtc.addDay(trip._id)">Save</button>
                            </div>
                        </div>

                    </ng-form>
                  </div> -->

            </div>
            <!--  END: Show days accord on group-->

        </div>
        <!--  END: Days accordion group-->

    </uib-accordion>
    <!--  END: Outer Accordion  -->
    </div>
